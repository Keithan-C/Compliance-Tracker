<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EU AI Act â€” Automotive Compliance Checklist</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=JetBrains+Mono:wght@300;400;500&family=Lora:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0c0c0f;
  --surface: #13131a;
  --surface-2: #1a1a24;
  --surface-3: #21212e;
  --border: rgba(255,255,255,0.07);
  --border-bright: rgba(255,255,255,0.14);
  --amber: #f5a623;
  --amber-dim: rgba(245,166,35,0.12);
  --amber-mid: rgba(245,166,35,0.25);
  --green: #22c55e;
  --green-dim: rgba(34,197,94,0.1);
  --red: #ef4444;
  --red-dim: rgba(239,68,68,0.1);
  --blue: #3b82f6;
  --blue-dim: rgba(59,130,246,0.1);
  --white: #ffffff;
  --white-90: rgba(255,255,255,0.9);
  --white-60: rgba(255,255,255,0.6);
  --white-30: rgba(255,255,255,0.3);
  --white-10: rgba(255,255,255,0.1);
  --white-05: rgba(255,255,255,0.05);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
  font-family: 'Lora', serif;
  background: var(--bg);
  color: var(--white-90);
  min-height: 100vh;
  overflow-x: hidden;
}

/* â”€â”€ NOISE TEXTURE â”€â”€ */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
  pointer-events: none;
  opacity: 0.4;
}

/* â”€â”€ GRID LINES â”€â”€ */
body::after {
  content: '';
  position: fixed; inset: 0; z-index: 0;
  background-image:
    linear-gradient(rgba(245,166,35,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(245,166,35,0.03) 1px, transparent 1px);
  background-size: 60px 60px;
  pointer-events: none;
}

.container {
  position: relative; z-index: 1;
  max-width: 860px; margin: 0 auto;
  padding: 0 24px 100px;
}

/* â”€â”€ HEADER â”€â”€ */
.header {
  padding: 56px 0 48px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 48px;
}

.header-top {
  display: flex; align-items: flex-start;
  justify-content: space-between; gap: 24px;
  flex-wrap: wrap;
  margin-bottom: 32px;
}

.header-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 0.2em;
  text-transform: uppercase; color: var(--amber);
  background: var(--amber-dim);
  border: 1px solid rgba(245,166,35,0.2);
  padding: 5px 12px; border-radius: 4px;
  display: inline-block; margin-bottom: 20px;
}

.header h1 {
  font-family: 'Syne', sans-serif;
  font-size: clamp(28px, 5vw, 46px);
  font-weight: 800; line-height: 1.05;
  letter-spacing: -0.03em;
  max-width: 600px;
}

.header h1 span { color: var(--amber); }

.header-right { flex-shrink: 0; text-align: right; }

.last-updated {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; color: var(--white-30);
  margin-bottom: 8px;
}

.reset-btn {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; color: var(--white-30);
  background: none; border: 1px solid var(--border);
  padding: 6px 12px; border-radius: 4px;
  cursor: pointer; letter-spacing: 0.05em;
  transition: all 0.2s;
}
.reset-btn:hover { color: var(--red); border-color: rgba(239,68,68,0.3); }

.header-desc {
  font-size: 15px; color: var(--white-60);
  line-height: 1.7; max-width: 600px;
  font-style: italic;
  margin-bottom: 32px;
}

/* â”€â”€ OVERALL PROGRESS â”€â”€ */
.overall-progress {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center; gap: 20px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px; padding: 20px 24px;
}

.overall-pct {
  font-family: 'Syne', sans-serif;
  font-size: 36px; font-weight: 800;
  color: var(--amber); letter-spacing: -0.04em;
  line-height: 1;
}

.overall-pct-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; color: var(--white-30);
  letter-spacing: 0.1em; text-transform: uppercase;
  margin-top: 4px;
}

.overall-track {
  height: 6px; background: var(--surface-3);
  border-radius: 3px; overflow: hidden;
}

.overall-fill {
  height: 100%; border-radius: 3px;
  background: linear-gradient(90deg, var(--amber), #ffd166);
  transition: width 0.6s cubic-bezier(0.4,0,0.2,1);
  width: 0%;
}

.overall-counts {
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px; color: var(--white-60);
  text-align: right; white-space: nowrap;
}

.overall-counts strong { color: var(--white-90); }

/* â”€â”€ SECTION GRID â”€â”€ */
.sections-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 12px; margin-bottom: 48px; margin-top: 16px;
}

.section-pill {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 10px; padding: 14px 16px;
  cursor: pointer; transition: all 0.2s;
  text-align: left;
}
.section-pill:hover { border-color: var(--border-bright); }
.section-pill.active { border-color: var(--amber); background: var(--amber-dim); }

.sp-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 9px; letter-spacing: 0.15em;
  text-transform: uppercase; color: var(--white-30);
  margin-bottom: 6px;
}
.section-pill.active .sp-label { color: var(--amber); }

.sp-name {
  font-family: 'Syne', sans-serif;
  font-size: 13px; font-weight: 600;
  color: var(--white-90); line-height: 1.3;
  margin-bottom: 10px;
}

.sp-bar-track {
  height: 3px; background: var(--surface-3); border-radius: 2px;
  margin-bottom: 6px; overflow: hidden;
}
.sp-bar-fill {
  height: 100%; border-radius: 2px;
  background: var(--amber);
  transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
  width: 0%;
}

.sp-count {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; color: var(--white-30);
}

/* â”€â”€ CHECKLIST SECTIONS â”€â”€ */
.checklist-section {
  margin-bottom: 48px;
  animation: fadeIn 0.4s ease both;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.section-header {
  display: flex; align-items: center; gap: 16px;
  margin-bottom: 20px; padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.section-icon {
  width: 40px; height: 40px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; flex-shrink: 0;
  background: var(--surface-2);
  border: 1px solid var(--border);
}

.section-meta { flex: 1; }

.section-article {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 0.15em;
  text-transform: uppercase; color: var(--amber);
  margin-bottom: 3px;
}

.section-title {
  font-family: 'Syne', sans-serif;
  font-size: 18px; font-weight: 700;
  letter-spacing: -0.02em;
}

.section-progress-text {
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px; color: var(--white-30);
  white-space: nowrap;
}

.section-progress-text strong { color: var(--green); }

/* â”€â”€ SUBSECTION â”€â”€ */
.subsection {
  margin-bottom: 28px;
}

.subsection-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 0.18em;
  text-transform: uppercase; color: var(--white-30);
  margin-bottom: 12px;
  display: flex; align-items: center; gap: 10px;
}
.subsection-label::after {
  content: ''; flex: 1; height: 1px;
  background: var(--border);
}

/* â”€â”€ CHECKLIST ITEM â”€â”€ */
.check-item {
  display: flex; align-items: flex-start; gap: 12px;
  padding: 12px 14px; border-radius: 8px;
  border: 1px solid transparent;
  transition: all 0.15s;
  cursor: pointer;
  margin-bottom: 4px;
  user-select: none;
}

.check-item:hover {
  background: var(--white-05);
  border-color: var(--border);
}

.check-item.checked {
  background: var(--green-dim);
  border-color: rgba(34,197,94,0.15);
}

.check-item.flagged {
  background: var(--red-dim);
  border-color: rgba(239,68,68,0.15);
}

.check-box {
  width: 18px; height: 18px; border-radius: 4px;
  border: 1.5px solid var(--border-bright);
  flex-shrink: 0; margin-top: 1px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.15s; background: transparent;
  position: relative;
}

.check-item.checked .check-box {
  background: var(--green);
  border-color: var(--green);
}

.check-item.checked .check-box::after {
  content: '';
  width: 5px; height: 9px;
  border-right: 2px solid white;
  border-bottom: 2px solid white;
  transform: rotate(45deg) translate(-1px, -1px);
  display: block;
}

.check-item.flagged .check-box {
  background: var(--red);
  border-color: var(--red);
}

.check-item.flagged .check-box::after {
  content: '!';
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 700;
  color: white; display: block;
}

.check-content { flex: 1; }

.check-text {
  font-size: 14px; line-height: 1.55;
  color: var(--white-90);
  transition: color 0.15s;
}

.check-item.checked .check-text {
  color: var(--white-60);
  text-decoration: line-through;
  text-decoration-color: rgba(34,197,94,0.4);
}

.check-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 9px; letter-spacing: 0.1em;
  text-transform: uppercase;
  padding: 2px 7px; border-radius: 3px;
  margin-left: 8px; vertical-align: middle;
  display: inline-block;
}

.tag-critical { background: rgba(239,68,68,0.15); color: #f87171; }
.tag-infra { background: var(--blue-dim); color: #93c5fd; }
.tag-doc { background: rgba(168,85,247,0.1); color: #c084fc; }

.check-actions {
  display: flex; gap: 4px; flex-shrink: 0;
  opacity: 0; transition: opacity 0.15s;
}
.check-item:hover .check-actions { opacity: 1; }

.action-btn {
  width: 24px; height: 24px; border-radius: 4px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--white-30); cursor: pointer;
  font-size: 12px; display: flex;
  align-items: center; justify-content: center;
  transition: all 0.15s;
}
.action-btn:hover { border-color: var(--border-bright); color: var(--white-90); }
.action-btn.flag-btn:hover { border-color: rgba(239,68,68,0.4); color: var(--red); }

/* â”€â”€ STATUS BAR â”€â”€ */
.status-bar {
  position: fixed; bottom: 0; left: 0; right: 0; z-index: 100;
  background: rgba(12,12,15,0.95);
  border-top: 1px solid var(--border);
  backdrop-filter: blur(20px);
  padding: 12px 24px;
  display: flex; align-items: center;
  justify-content: space-between; gap: 16px;
  flex-wrap: wrap;
}

.status-left {
  display: flex; align-items: center; gap: 20px;
}

.status-stat {
  display: flex; align-items: center; gap: 8px;
}

.status-dot {
  width: 8px; height: 8px; border-radius: 50%;
}

.dot-complete { background: var(--green); }
.dot-remaining { background: var(--white-30); }
.dot-flagged { background: var(--red); }

.status-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; color: var(--white-60);
}

.status-label strong { color: var(--white-90); }

.status-right {
  display: flex; gap: 8px;
}

.export-btn {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; letter-spacing: 0.05em;
  padding: 8px 16px; border-radius: 6px;
  cursor: pointer; transition: all 0.2s;
  display: flex; align-items: center; gap: 6px;
  white-space: nowrap;
}

.export-pdf {
  background: var(--amber-dim);
  border: 1px solid rgba(245,166,35,0.3);
  color: var(--amber);
}
.export-pdf:hover { background: var(--amber-mid); }

.export-copy {
  background: var(--surface-2);
  border: 1px solid var(--border);
  color: var(--white-60);
}
.export-copy:hover { color: var(--white-90); border-color: var(--border-bright); }

/* â”€â”€ DEADLINE BANNER â”€â”€ */
.deadline-banner {
  background: var(--surface);
  border: 1px solid var(--border);
  border-left: 3px solid var(--amber);
  border-radius: 8px; padding: 14px 20px;
  margin-bottom: 32px;
  display: flex; align-items: center; gap: 16px;
  flex-wrap: wrap;
}

.deadline-count {
  font-family: 'Syne', sans-serif;
  font-size: 28px; font-weight: 800;
  color: var(--amber); letter-spacing: -0.03em;
  white-space: nowrap;
}

.deadline-text {
  font-size: 13px; color: var(--white-60);
  line-height: 1.5;
}

.deadline-text strong { color: var(--white-90); }

/* â”€â”€ TOOLTIP â”€â”€ */
.note-chip {
  display: inline-block;
  font-family: 'JetBrains Mono', monospace;
  font-size: 9px; color: var(--white-30);
  background: var(--surface-3); border-radius: 3px;
  padding: 1px 6px; margin-top: 4px;
  letter-spacing: 0.05em;
}

/* â”€â”€ COMPLETION STATE â”€â”€ */
.completion-banner {
  display: none;
  text-align: center; padding: 40px;
  background: var(--green-dim);
  border: 1px solid rgba(34,197,94,0.2);
  border-radius: 12px; margin-bottom: 32px;
  animation: fadeIn 0.5s ease;
}

.completion-banner.show { display: block; }

.completion-banner h2 {
  font-family: 'Syne', sans-serif;
  font-size: 24px; font-weight: 800;
  color: var(--green); margin-bottom: 8px;
}

.completion-banner p {
  font-size: 14px; color: var(--white-60);
  font-style: italic;
}

/* â”€â”€ PRINT STYLES â”€â”€ */
@media print {
  body { background: white; color: black; }
  body::before, body::after { display: none; }
  .status-bar, .check-actions, .section-pill, .sections-grid { display: none; }
  .check-item { break-inside: avoid; }
  .check-text { color: black !important; }
  .check-item.checked .check-text { color: #666 !important; }
  .header h1 { color: black; }
  .header h1 span { color: #b45309; }
  .container { padding-bottom: 20px; }
}

/* scrollbar */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--surface-3); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--border-bright); }
</style>
</head>
<body>

<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="header-tag">EU AI Act Â· Automotive Compliance Â· Living Checklist</div>
    <div class="header-top">
      <div>
        <h1>Article 4, 12 & 19<br><span>Compliance Tracker</span></h1>
      </div>
      <div class="header-right">
        <div class="last-updated" id="last-updated">Never updated</div>
        <button class="reset-btn" onclick="resetAll()">â†º Reset all</button>
      </div>
    </div>
    <p class="header-desc">
      A living checklist for automotive OTA infrastructure and ADAS engineering teams. 
      Check items as you complete them â€” progress saves automatically in your browser. 
      Flag items that are blocked or need attention.
    </p>

    <div class="overall-progress">
      <div>
        <div class="overall-pct" id="overall-pct">0%</div>
        <div class="overall-pct-label">Complete</div>
      </div>
      <div>
        <div class="overall-track">
          <div class="overall-fill" id="overall-fill"></div>
        </div>
      </div>
      <div class="overall-counts" id="overall-counts">
        <strong>0</strong> of <strong id="total-count">0</strong> items
      </div>
    </div>
  </div>

  <!-- DEADLINE BANNER -->
  <div class="deadline-banner">
    <div class="deadline-count" id="days-left">â€”</div>
    <div class="deadline-text">
      <strong>days until EU AI Act enforcement</strong><br>
      August 2, 2026 Â· Article 12 and 19 logging requirements apply to all high-risk AI systems
    </div>
  </div>

  <!-- SECTION PILLS -->
  <div class="sections-grid" id="section-pills"></div>

  <!-- COMPLETION BANNER -->
  <div class="completion-banner" id="completion-banner">
    <h2>âœ“ All items complete</h2>
    <p>Your infrastructure readiness checklist is fully completed. Consider scheduling a quarterly review to maintain compliance as your AI systems evolve.</p>
  </div>

  <!-- CHECKLIST -->
  <div id="checklist-body"></div>

</div>

<!-- STATUS BAR -->
<div class="status-bar">
  <div class="status-left">
    <div class="status-stat">
      <div class="status-dot dot-complete"></div>
      <div class="status-label"><strong id="bar-done">0</strong> done</div>
    </div>
    <div class="status-stat">
      <div class="status-dot dot-remaining"></div>
      <div class="status-label"><strong id="bar-remaining">0</strong> remaining</div>
    </div>
    <div class="status-stat">
      <div class="status-dot dot-flagged"></div>
      <div class="status-label"><strong id="bar-flagged">0</strong> flagged</div>
    </div>
  </div>
  <div class="status-right">
    <button class="export-btn export-copy" onclick="copyStatus()">â§‰ Copy status</button>
    <button class="export-btn export-pdf" onclick="window.print()">â†“ Print / PDF</button>
  </div>
</div>

<script>
// â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SECTIONS = [
  {
    id: 'art4',
    icon: 'ðŸŽ“',
    article: 'Article 4',
    title: 'AI Literacy & Team Readiness',
    subsections: [
      {
        label: 'Organisational Awareness',
        items: [
          { id: 'a4-1', text: 'All staff working with high-risk AI systems have completed EU AI Act literacy training', tags: ['critical'] },
          { id: 'a4-2', text: 'ADAS engineering leads understand Article 12 logging obligations for systems they develop', tags: ['critical'] },
          { id: 'a4-3', text: 'Product owners and QA teams can articulate high-risk AI classification criteria under Annex III', tags: [] },
          { id: 'a4-4', text: 'Infrastructure team (eSIM/ACSP) understands their role in enabling Article 12 compliance', tags: ['infra'] },
        ]
      },
      {
        label: 'High-Risk Classification',
        items: [
          { id: 'a4-5', text: 'Complete inventory of AI systems assessed against Annex III high-risk criteria', tags: ['critical'] },
          { id: 'a4-6', text: 'Level 2 and Level 3 ADAS systems formally classified as high-risk and documented', tags: ['critical'] },
          { id: 'a4-7', text: 'Classification decisions reviewed by legal or compliance team', tags: ['doc'] },
          { id: 'a4-8', text: 'Classification register maintained and updated when new AI systems are deployed', tags: ['doc'] },
        ]
      }
    ]
  },
  {
    id: 'art12',
    icon: 'ðŸ“¡',
    article: 'Article 12',
    title: 'Logging Capability',
    subsections: [
      {
        label: 'Logging Architecture',
        items: [
          { id: 'a12-1', text: 'Automatic logging enabled for all high-risk AI systems â€” no manual trigger required', tags: ['critical', 'infra'] },
          { id: 'a12-2', text: 'Logging active during all operational use, not just testing or development environments', tags: ['critical'] },
          { id: 'a12-3', text: 'OTA deployment events captured with timestamp, model version, and deployment scope', tags: ['infra'] },
          { id: 'a12-4', text: 'eSIM/ACSP infrastructure configured to capture AI-specific compliance log fields', tags: ['infra', 'critical'] },
          { id: 'a12-5', text: 'Logging survives system restart and network interruption without data loss', tags: ['infra'] },
        ]
      },
      {
        label: 'Data Captured Per AI System',
        items: [
          { id: 'a12-6', text: 'Model inputs logged â€” sensor feeds, environmental conditions, vehicle state', tags: ['critical'] },
          { id: 'a12-7', text: 'Model outputs logged â€” decisions, recommendations, confidence scores', tags: ['critical'] },
          { id: 'a12-8', text: 'Human override and driver intervention events captured systematically', tags: ['critical'] },
          { id: 'a12-9', text: 'System failure, fallback, and degradation events logged with error context', tags: [] },
          { id: 'a12-10', text: 'Deployed model version identifier included in every log entry', tags: ['infra'] },
          { id: 'a12-11', text: 'Geographic and temporal context captured per log event', tags: [] },
        ]
      },
      {
        label: 'Logging Schemas',
        items: [
          { id: 'a12-12', text: 'Defined logging schema exists for each high-risk AI system', tags: ['critical', 'doc'] },
          { id: 'a12-13', text: 'Schema explicitly maps each data field to the specific Article 12 requirement it satisfies', tags: ['doc'] },
          { id: 'a12-14', text: 'Schema reviewed and approved by compliance or legal team', tags: ['doc'] },
          { id: 'a12-15', text: 'Schema version-controlled alongside model versions in your repository', tags: [] },
          { id: 'a12-16', text: 'Infrastructure implementation spec derived from schema and handed to eSIM/ACSP team', tags: ['infra', 'doc'] },
        ]
      },
      {
        label: 'Retrieval Capability',
        items: [
          { id: 'a12-17', text: 'Logs retrievable within 48 hours of a regulator request â€” tested and confirmed', tags: ['critical'] },
          { id: 'a12-18', text: 'Export format documented (JSON, CSV, or XML) and reviewed for readability', tags: ['doc'] },
          { id: 'a12-19', text: 'Retrieval procedure written, assigned to a named owner, and tested under realistic conditions', tags: ['doc'] },
          { id: 'a12-20', text: 'Retrieval tested for 6-month log volume without performance degradation', tags: [] },
        ]
      }
    ]
  },
  {
    id: 'art19',
    icon: 'ðŸ”’',
    article: 'Article 19',
    title: 'Log Control',
    subsections: [
      {
        label: 'Retention Policy',
        items: [
          { id: 'a19-1', text: 'Minimum log retention period defined and documented per AI system', tags: ['critical', 'doc'] },
          { id: 'a19-2', text: 'Retention period reviewed against national supervisory authority guidance', tags: [] },
          { id: 'a19-3', text: 'Archival process automated â€” not dependent on manual intervention', tags: ['infra'] },
          { id: 'a19-4', text: 'Deletion procedure documented with approval workflow and audit trail', tags: ['doc'] },
          { id: 'a19-5', text: 'Retention policy reviewed and re-approved annually', tags: [] },
        ]
      },
      {
        label: 'Access Control',
        items: [
          { id: 'a19-6', text: 'Log access restricted by role â€” not open to all engineering staff', tags: ['critical', 'infra'] },
          { id: 'a19-7', text: 'Approved access list documented and reviewed quarterly', tags: ['doc'] },
          { id: 'a19-8', text: 'Access audit trail enabled â€” who accessed logs, when, and what was exported', tags: ['critical', 'infra'] },
          { id: 'a19-9', text: 'Privileged access (admin/override) requires dual approval', tags: [] },
          { id: 'a19-10', text: 'Access control tested by attempting unauthorised retrieval (pen test)', tags: [] },
        ]
      },
      {
        label: 'Integrity Protection',
        items: [
          { id: 'a19-11', text: 'Logs technically protected against deletion or modification after writing', tags: ['critical', 'infra'] },
          { id: 'a19-12', text: 'Integrity verification mechanism in place â€” hash or cryptographic signature per entry', tags: ['infra'] },
          { id: 'a19-13', text: 'Tampering detection alerts configured â€” notifies compliance team if breach detected', tags: ['infra'] },
          { id: 'a19-14', text: 'Integrity approach documented for audit evidence â€” not just assumed', tags: ['doc'] },
        ]
      }
    ]
  },
  {
    id: 'audit',
    icon: 'ðŸ“‹',
    article: 'Audit Readiness',
    title: 'Documentation & Defence',
    subsections: [
      {
        label: 'Core Documentation',
        items: [
          { id: 'aud-1', text: 'Audit Defense Brief completed for each high-risk AI system', tags: ['critical', 'doc'] },
          { id: 'aud-2', text: 'Brief explains logging compliance in plain language understandable to non-technical regulators', tags: ['doc'] },
          { id: 'aud-3', text: 'Brief reviewed and signed off by legal team', tags: ['doc'] },
          { id: 'aud-4', text: 'Infrastructure Implementation Spec completed and stored alongside system documentation', tags: ['infra', 'doc'] },
          { id: 'aud-5', text: 'Technical documentation register maintained with version history', tags: ['doc'] },
        ]
      },
      {
        label: 'Team Readiness',
        items: [
          { id: 'aud-6', text: 'ADAS engineers can explain their logging compliance approach without preparation time', tags: ['critical'] },
          { id: 'aud-7', text: 'Designated compliance spokesperson identified and briefed per AI system', tags: [] },
          { id: 'aud-8', text: 'Mock audit simulation conducted â€” engineering team interrogated by internal reviewer', tags: [] },
          { id: 'aud-9', text: 'Gap remediation plan documented, dated, and assigned to named owners', tags: ['doc'] },
          { id: 'aud-10', text: 'Quarterly compliance review scheduled with infrastructure and ADAS teams', tags: [] },
        ]
      }
    ]
  }
];

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let state = JSON.parse(localStorage.getItem('ai-act-checklist') || '{}');

function saveState() {
  localStorage.setItem('ai-act-checklist', JSON.stringify(state));
  const now = new Date();
  document.getElementById('last-updated').textContent =
    'Updated ' + now.toLocaleDateString('en-GB', { day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' });
}

// â”€â”€ DEADLINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateDeadline() {
  const deadline = new Date('2026-08-02');
  const now = new Date();
  const diff = Math.ceil((deadline - now) / (1000 * 60 * 60 * 24));
  document.getElementById('days-left').textContent = diff.toLocaleString() + ' days';
}

// â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function render() {
  const body = document.getElementById('checklist-body');
  const pillsContainer = document.getElementById('section-pills');
  body.innerHTML = '';
  pillsContainer.innerHTML = '';

  let totalItems = 0;
  let totalDone = 0;

  SECTIONS.forEach(section => {
    // Count section items
    let secTotal = 0;
    let secDone = 0;
    section.subsections.forEach(sub => {
      sub.items.forEach(item => {
        secTotal++;
        totalItems++;
        if (state[item.id] === 'checked') { secDone++; totalDone++; }
      });
    });

    // Pill
    const pill = document.createElement('div');
    pill.className = 'section-pill';
    pill.id = 'pill-' + section.id;
    pill.innerHTML = `
      <div class="sp-label">${section.article}</div>
      <div class="sp-name">${section.title}</div>
      <div class="sp-bar-track"><div class="sp-bar-fill" id="spbar-${section.id}" style="width:${secTotal ? Math.round(secDone/secTotal*100) : 0}%"></div></div>
      <div class="sp-count">${secDone}/${secTotal}</div>
    `;
    pill.onclick = () => {
      document.getElementById('sec-' + section.id)?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    };
    pillsContainer.appendChild(pill);

    // Section
    const secEl = document.createElement('div');
    secEl.className = 'checklist-section';
    secEl.id = 'sec-' + section.id;

    let subsHtml = '';
    section.subsections.forEach(sub => {
      let itemsHtml = '';
      sub.items.forEach(item => {
        const s = state[item.id] || 'unchecked';
        const tagHtml = item.tags.map(t => {
          const labels = { critical: 'CRITICAL', infra: 'INFRASTRUCTURE', doc: 'DOCUMENTATION' };
          return `<span class="check-tag tag-${t}">${labels[t]}</span>`;
        }).join('');

        itemsHtml += `
          <div class="check-item ${s === 'checked' ? 'checked' : s === 'flagged' ? 'flagged' : ''}"
               id="item-${item.id}" onclick="toggleItem('${item.id}', event)">
            <div class="check-box"></div>
            <div class="check-content">
              <div class="check-text">${item.text}${tagHtml}</div>
            </div>
            <div class="check-actions" onclick="e => e.stopPropagation()">
              <button class="action-btn flag-btn" title="Flag as blocked"
                onclick="flagItem('${item.id}', event)">âš‘</button>
            </div>
          </div>`;
      });

      subsHtml += `
        <div class="subsection">
          <div class="subsection-label">${sub.label}</div>
          ${itemsHtml}
        </div>`;
    });

    secEl.innerHTML = `
      <div class="section-header">
        <div class="section-icon">${section.icon}</div>
        <div class="section-meta">
          <div class="section-article">${section.article}</div>
          <div class="section-title">${section.title}</div>
        </div>
        <div class="section-progress-text">
          <strong>${secDone}/${secTotal}</strong> complete
        </div>
      </div>
      ${subsHtml}
    `;
    body.appendChild(secEl);
  });

  // Update overall
  const pct = totalItems ? Math.round(totalDone / totalItems * 100) : 0;
  document.getElementById('overall-pct').textContent = pct + '%';
  document.getElementById('overall-fill').style.width = pct + '%';
  document.getElementById('overall-counts').innerHTML = `<strong>${totalDone}</strong> of <strong>${totalItems}</strong> items`;
  document.getElementById('total-count').textContent = totalItems;
  document.getElementById('bar-done').textContent = totalDone;
  document.getElementById('bar-remaining').textContent = totalItems - totalDone - countFlagged();
  document.getElementById('bar-flagged').textContent = countFlagged();

  // Completion banner
  document.getElementById('completion-banner').classList.toggle('show', totalDone === totalItems && totalItems > 0);
}

function countFlagged() {
  return Object.values(state).filter(v => v === 'flagged').length;
}

// â”€â”€ INTERACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleItem(id, event) {
  if (event.target.classList.contains('action-btn')) return;
  const current = state[id] || 'unchecked';
  state[id] = current === 'checked' ? 'unchecked' : 'checked';
  saveState();

  // Fast update without full re-render
  const el = document.getElementById('item-' + id);
  el.classList.remove('checked', 'flagged');
  if (state[id] === 'checked') el.classList.add('checked');
  updateCounters();
}

function flagItem(id, event) {
  event.stopPropagation();
  const current = state[id] || 'unchecked';
  state[id] = current === 'flagged' ? 'unchecked' : 'flagged';
  saveState();

  const el = document.getElementById('item-' + id);
  el.classList.remove('checked', 'flagged');
  if (state[id] === 'flagged') el.classList.add('flagged');
  updateCounters();
}

function updateCounters() {
  let totalItems = 0, totalDone = 0;
  SECTIONS.forEach(section => {
    let secTotal = 0, secDone = 0;
    section.subsections.forEach(sub => {
      sub.items.forEach(item => {
        secTotal++; totalItems++;
        if (state[item.id] === 'checked') { secDone++; totalDone++; }
      });
    });
    const pct = secTotal ? Math.round(secDone / secTotal * 100) : 0;
    const bar = document.getElementById('spbar-' + section.id);
    if (bar) bar.style.width = pct + '%';
    const pill = document.getElementById('pill-' + section.id);
    if (pill) pill.querySelector('.sp-count').textContent = secDone + '/' + secTotal;
  });

  const pct = totalItems ? Math.round(totalDone / totalItems * 100) : 0;
  document.getElementById('overall-pct').textContent = pct + '%';
  document.getElementById('overall-fill').style.width = pct + '%';
  document.getElementById('overall-counts').innerHTML = `<strong>${totalDone}</strong> of <strong>${totalItems}</strong> items`;
  document.getElementById('bar-done').textContent = totalDone;
  document.getElementById('bar-remaining').textContent = totalItems - totalDone - countFlagged();
  document.getElementById('bar-flagged').textContent = countFlagged();
  document.getElementById('completion-banner').classList.toggle('show', totalDone === totalItems);
}

function resetAll() {
  if (!confirm('Reset all checklist progress? This cannot be undone.')) return;
  state = {};
  saveState();
  render();
}

function copyStatus() {
  let totalItems = 0, totalDone = 0;
  SECTIONS.forEach(section => {
    section.subsections.forEach(sub => {
      sub.items.forEach(item => {
        totalItems++;
        if (state[item.id] === 'checked') totalDone++;
      });
    });
  });

  const pct = totalItems ? Math.round(totalDone / totalItems * 100) : 0;
  const flagged = countFlagged();
  const text = `EU AI Act Compliance Checklist Status
Date: ${new Date().toLocaleDateString('en-GB')}
Overall: ${totalDone}/${totalItems} items complete (${pct}%)
Flagged/Blocked: ${flagged} items
Remaining: ${totalItems - totalDone - flagged} items

Generated by LXD Advisory Â· Article 12/19 Compliance Tracker`;

  navigator.clipboard.writeText(text).then(() => {
    const btn = document.querySelector('.export-copy');
    btn.textContent = 'âœ“ Copied';
    setTimeout(() => btn.textContent = 'â§‰ Copy status', 2000);
  });
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
updateDeadline();
render();

if (Object.keys(state).length > 0) {
  const saved = new Date(localStorage.getItem('ai-act-checklist-date') || Date.now());
  document.getElementById('last-updated').textContent =
    'Progress saved Â· ' + new Date().toLocaleDateString('en-GB', { day:'numeric', month:'short' });
}

// Save timestamp
const origSave = saveState;
window.saveState = function() {
  localStorage.setItem('ai-act-checklist-date', Date.now());
  origSave();
};
</script>
</body>
</html>
